<?phprequire_once("./inc/connect_db.php");// this file returns an xml file that confirms that the email address is updated and they agreement number the borrower has signed$y = true;if ($barcode) {	header("Content-type: text/xml");		$barcode = addslashes($barcode);		print("<?xml version=\"1.0\" encoding=\"iso-8859-1\"?>	<data>	");		$query = "SELECT assets.asset_description, assets.notes, assets.serial_number, assets.barcode,	assets_logged_out.out_time, assets_logged_out.due_time, assets_logged_out.in_time,	borrowers.first_name, borrowers.last_name, borrowers.student_id, borrowers.dc_email, borrowers.other_email	FROM assets, assets_logged_out, borrowers	WHERE assets.id = assets_logged_out.assets_id	AND assets_logged_out.borrowers_id = borrowers.id	AND assets.barcode = '$barcode' 	ORDER BY assets_logged_out.out_time DESC";	//print("$query<br />");	$mysql_result = mysql_query($query, $mysql_link);	while($row = mysql_fetch_row($mysql_result)) {		$assets_asset_description = stripslashes($row[0]);		$assets_notes = htmlspecialchars(stripslashes($row[1]));		$assets_serial_number = htmlspecialchars(stripslashes($row[2]));		$assets_barcode = htmlspecialchars(stripslashes($row[3]));		$assets_logged_out_out_time = date("D d M Y h:i:s A",htmlspecialchars(stripslashes($row[4])));		$assets_logged_out_due_time = date("D d M Y h:i:s A",htmlspecialchars(stripslashes($row[5])));		$assets_logged_out_in_time = date("D d M Y h:i:s A",htmlspecialchars(stripslashes($row[6])));		$borrowers_first_name = htmlspecialchars(stripslashes($row[7]));		$borrowers_last_name = htmlspecialchars(stripslashes($row[8]));		$borrowers_student_id = htmlspecialchars(stripslashes($row[9]));		$borrowers_dc_email = htmlspecialchars(stripslashes($row[10]));		$borrowers_other_email = htmlspecialchars(stripslashes($row[11]));		if ($row[5] < mktime()) {			$overdue = 1;		} else {			$overdue = 0;		}		if ($row[6] == "0") {			$assets_logged_out_in_time = "";		}						print("<asset_types>		<asset_description>$assets_asset_description</asset_description>		<assets_notes>$assets_notes</assets_notes>		<assets_serial_number>$assets_serial_number</assets_serial_number>		<assets_barcode>$assets_barcode</assets_barcode>		<assets_logged_out_out_time>$assets_logged_out_out_time</assets_logged_out_out_time>		<assets_logged_out_due_time>$assets_logged_out_due_time</assets_logged_out_due_time>		<assets_logged_out_in_time>$assets_logged_out_in_time</assets_logged_out_in_time>		<borrowers_first_name>$borrowers_first_name</borrowers_first_name>		<borrowers_last_name>$borrowers_last_name</borrowers_last_name>		<borrowers_student_id>$borrowers_student_id</borrowers_student_id>		<borrowers_dc_email>$borrowers_dc_email</borrowers_dc_email>		<borrowers_other_email>$borrowers_other_email</borrowers_other_email>		<overdue>$overdue</overdue>		</asset_types>		");			}	print("</data>	");} elseif ($y) {	header("Content-type: text/xml");		print("<?xml version=\"1.0\" encoding=\"iso-8859-1\"?>	<data>	");		$query = "SELECT assets.asset_description, assets.barcode	FROM assets	ORDER BY barcode ";		$mysql_result = mysql_query($query, $mysql_link);	while($row = mysql_fetch_row($mysql_result)) {		$assets_asset_description = stripslashes($row[0]);		$assets_barcode = htmlspecialchars(stripslashes($row[1]));		print("<asset_types>		<asset_description>$assets_asset_description</asset_description>		<assets_barcode>$assets_barcode</assets_barcode>		</asset_types>		");	}	print("</data>	");			} else {	// send no access allowed	header("Content-type: text/xml");	print("<?xml version=\"1.0\" encoding=\"iso-8859-1\"?>	<data>		<student_id>$student_id</student_id>		<error>Update Failed!</error>	</data>	");}$dbh = null;?>