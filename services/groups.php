<?phprequire_once("./inc/connect_db.php");// this file returns an xml file that confirms that the email address is updated and they agreement number the borrower has signed$y = true;// check that records are there for all programs and yearsif ($name && $id) {	$name = addslashes($name);	$query = "UPDATE groups	SET name = '$name'	WHERE id = '$id' ";	//print("$query<br />");	$mysql_result = mysql_query($query, $mysql_link);}$query = "SELECT idFROM programs ORDER BY id";//print("$query<br />");$mysql_result = mysql_query($query, $mysql_link);while($row = mysql_fetch_row($mysql_result)) {	$programs_id = stripslashes($row[0]);		for ($x=1;$x<=3;++$x) {		unset($groups_id);		$query2 = "SELECT id		FROM groups		WHERE programs_id = '$programs_id'		AND year = '$x' ";		//print("$query<br />");		$mysql_result2 = mysql_query($query2, $mysql_link);		while($row2 = mysql_fetch_row($mysql_result2)) {			$groups_id = stripslashes($row2[0]);		}		if (empty($groups_id)) {			$query2 = "INSERT INTO groups			SET programs_id = '$programs_id',			year = '$x' ";			//print("$query<br />");			$mysql_result2 = mysql_query($query2, $mysql_link);		}	}}if ($y) {	header("Content-type: text/xml");			print("<?xml version=\"1.0\" encoding=\"iso-8859-1\"?>	<groups>	");		$student_id = addslashes($student_id);		$total = 0;	$query = "SELECT id, name, programs_id, year	FROM groups	ORDER BY programs_id, year";	//print("$query<br />");	$mysql_result = mysql_query($query, $mysql_link);	while($row = mysql_fetch_row($mysql_result)) {		$groups_id = stripslashes($row[0]);		$groups_name = htmlspecialchars(stripslashes($row[1]));		$groups_programs_id = htmlspecialchars(stripslashes($row[2]));		$groups_year = htmlspecialchars(stripslashes($row[3]));				$query2 = "SELECT name		FROM programs		WHERE id = '$groups_programs_id' ";		//print("$query<br />");		$mysql_result2 = mysql_query($query2, $mysql_link);		while($row2 = mysql_fetch_row($mysql_result2)) {			$programs_name = stripslashes($row2[0]);		}				print("<group>		<id>$groups_id</id>		<name>$groups_name</name>		<program_name>$programs_name</program_name>		<program_id>$groups_programs_id</program_id>		<year>$groups_year</year>		</group>		");	}	print("</groups>	");	} else {	// send no access allowed	header("Content-type: text/xml");	print("<?xml version=\"1.0\" encoding=\"iso-8859-1\"?>	<data>				");		print("<asset_types>		<student_id>$student_id</student_id>		<error>Update Failed!</error>		<asset_description>$assets_asset_description</asset_description>		<assets_notes>$assets_notes</assets_notes>		<assets_serial_number>$assets_serial_number</assets_serial_number>		<assets_barcode>$assets_barcode</assets_barcode>		<assets_logged_out_out_time>$assets_logged_out_out_time</assets_logged_out_out_time>		<assets_logged_out_due_time>$assets_logged_out_due_time</assets_logged_out_due_time>		<assets_logged_out_in_time>$assets_logged_out_in_time</assets_logged_out_in_time>		<borrowers_first_name>$borrowers_first_name</borrowers_first_name>		<borrowers_last_name>$borrowers_last_name</borrowers_last_name>		<borrowers_student_id>$borrowers_student_id</borrowers_student_id>		<borrowers_dc_email>$borrowers_dc_email</borrowers_dc_email>		<borrowers_other_email>$borrowers_other_email</borrowers_other_email>		<overdue>$overdue</overdue>		</asset_types>		");	print("</data>	");}?>